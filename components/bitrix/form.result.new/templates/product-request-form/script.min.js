BX.namespace("BX.JCWebForm"),function(){"use strict";BX.JCWebForm={init:function(e){this.result=e.result,this.form=document.querySelector("[name="+this.result.FORM_NAME),this.webFormId=this.form.querySelector('[name="WEB_FORM_ID"]').value,this.formButton=this.form.querySelector('[type="submit"]'),this.phoneField=this.form.querySelector(".callback-form__phone-field input"),this.pathToAjax=this.result.PATH_TO_AJAX,this.useCaptcha=this.result.USE_CAPTCHA,this.error=!1,this.arrayInputs=this.result.INPUTS,this.useCaptcha&&this.initializeCaptcha(),this.setMaskForPhone(this.phoneField),this.eventActivation(),BX.bind(this.form,"submit",BX.proxy(this.send,this))},send:function(e){let t;if(this.error=!1,t=this.formFieldValues(this.arrayInputs),BX.PreventDefault(e),1==this.error)return!1;BX.ajax.submitAjax(this.form,{url:this.pathToAjax,method:"POST",dataType:"json",data:{fieldValues:t,webFormId:this.webFormId},onsuccess:function(e,t){let i=BX.JCWebForm.form;i.classList.add("disabled","success"),i.after(BX.create("DIV",{props:{className:"form-result"},text:BX.message("FORM_DATA_SUCCESS")}))},onfailure:function(e,t){let i=BX.JCWebForm.form;i.classList.add("disabled","false"),i.after(BX.create("DIV",{props:{className:"form-result"},text:BX.message("FORM_DATA_FALSE")}))}})},setMaskForPhone:function(e){let t;t=new BX.MaskedInput({mask:"+7 999 999 99 99",input:e,placeholder:"_",dataInput:{},onDataInputChange:function(e,t){""==e.length?this.input.node.classList.remove("callback-form__field-not-empty"):this.input.node.classList.add("callback-form__field-not-empty")},onDataInputInitValue:function(){}})},initializeCaptcha:function(){try{Recaptchafree.reset()}catch(e){}},formFieldValues:function(e){let t,i=[];for(var s in e)t=document.querySelector("[name='"+e[s].DATA_NAME+"']"),this.fieldValidation(t),i[e[s].DATA_NAME]=t.value;return i},fieldValidation:function(e){let t,i,s,r="FORM_REQUIRED_FIELDS";i=e.dataset.validation,s=new RegExp(e.pattern,"gm"),0!=e.dataset.pattern.length&&(t=s.test(e.value)),"tel"==i&&e.value.length>0&&0==t&&(r="FORM_REQUIRED_TELEPHONE"),""==e.value.length||!1===t?(this.showError(e,r),this.error=!0):this.hideError(e)},showError:function(e,t){let i=e.previousElementSibling;if(null!=i&&i.classList.contains("form-error"))return i.innerText=BX.message(t),!1;0==t.length&&(t="FORM_REQUIRED_FIELDS"),e.before(BX.create("SPAN",{props:{className:"form-error"},text:BX.message(t)})),e.classList.add("form-error-field")},hideError:function(e){let t=e.previousElementSibling;if(null==t)return!1;t.classList.contains("form-error"),e.previousElementSibling.remove(),e.classList.remove("form-error-field")},eventActivation:function(){this.fieldFillingEvent(this.arrayInputs)},fieldFillingEvent:function(e){let t;for(var i in e)t=document.querySelector("[name='"+e[i].DATA_NAME+"']"),BX.bind(t,"input",(function(e){""==e.target.value.length?this.classList.remove("callback-form__field-not-empty"):this.classList.add("callback-form__field-not-empty")}))}}}();
